language: cpp

sudo: false

dist: xenial

cache:
  timeout: 1000
  pip: true
  directories:
    - $HOME/Library/Caches/Homebrew

matrix:
  fast_finish: true
  include:
    - os: linux
      addons:
        apt:
          packages:
            - g++
            - gcc
      env:
        - WHICH=externalproject
        - WHICH=fetchcontent
    - os: osx
      env:
        - WHICH=externalproject
        - WHICH=fetchcontent

install:
  - ./.scripts/travis/install.sh
  - pipenv install --three
  - pipenv run python --version

before_script:
  - test -n $CC && unset CC && export CC=gcc;
  - test -n $CXX && unset CXX && export CXX=g++;

script:
  - export PATH=$HOME/Deps/cmake/$CMAKE_VERSION/bin${PATH:+:$PATH}
  - cmake -H"$WHICH" -Bbuild
  - cmake --build build -- VERBOSE=1
  # Testing
